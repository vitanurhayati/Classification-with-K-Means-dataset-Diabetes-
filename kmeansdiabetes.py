# -*- coding: utf-8 -*-
"""kmeansdiabetes.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15Okoue38IwWWNjaARgS0hY4_q8XLdqrV
"""

from pandas import DataFrame
import pandas as pd
import numpy as np

df = pd.read_csv("diabetes.csv")

df.shape
df.describe

df.info()

from sklearn.preprocessing import LabelEncoder

le=LabelEncoder()
for col in df.columns.values:
  if df[col].dtype=='object':
    data=df[col].append(df[col])
    le.fit(data.values)
    df[col]=le.transform(df[col])
df.head(10)

df[["Glucose", "BloodPressure", "SkinThickness", "Insulin", "BMI"]]=df[["Glucose", "BloodPressure", "SkinThickness", "Insulin", "BMI"]].replace(0, np.nan)

df.head(10)

df.isnull().sum()

df.columns

df.isnull().sum()

# Replacing NaN with mean values
df["Glucose"].fillna(df["Glucose"].mean(), inplace = True)
df["BloodPressure"].fillna(df["BloodPressure"].mean(), inplace = True)
df["SkinThickness"].fillna(df["SkinThickness"].mean(), inplace = True)
df["Insulin"].fillna(df["Insulin"].mean(), inplace = True)
df["BMI"].fillna(df["BMI"].mean(), inplace = True)

df.describe
df.head(10)

# Feature scaling using MinMaxScaler
from sklearn.preprocessing import MinMaxScaler
sc = MinMaxScaler(feature_range = (0, 1))
dataset_scaled = sc.fit_transform(df)

data1 = pd.DataFrame(dataset_scaled)
data1

import seaborn as sns
import matplotlib.pyplot as plt
# Heatmap
sns.heatmap(data1.corr(), annot = True)
plt.show()

# Detailed distribution of the features in the dataset
sns.pairplot(data=data1, hue=7)
plt.show()

df.columns

# Selecting features - [Glucose, Insulin, BMI]
X = data1.iloc[:, [0, 3, 4]].values
Y = data1.iloc[:, 7].values

# Splitting X and Y
from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.20, random_state = 42, stratify = df['Status'] )

# Checking dimensions
print("X_train shape:", X_train.shape)
print("X_test shape:", X_test.shape)
print("Y_train shape:", Y_train.shape)
print("Y_test shape:", Y_test.shape)

import sklearn
from sklearn.cluster import KMeans
KMeans_Clustering = KMeans(n_clusters =2, random_state=0)
KMeans_Clustering.fit(X_train)

print(KMeans_Clustering.cluster_centers_)

#prediction using kmeans and accuracy
kpred = KMeans_Clustering.predict(X_test)

print('Classification report:\n\n', sklearn.metrics.classification_report(Y_test,kpred))

#confusion matrix
from sklearn.metrics import confusion_matrix
print("Confusion Matrix :")
outcome_labels = sorted(df.Status.unique())
sns.heatmap(
    confusion_matrix(Y_test, kpred),
    annot=True,
    xticklabels=outcome_labels,
    yticklabels=outcome_labels
)

out = KMeans_Clustering.predict([[0.53,0.54,0.5253]])
if (out==0):
    print("No Diabetes")
else:
    print("Diabetes")

#actual data
plt.scatter(data1.iloc[:, [1]].values,data1.iloc[:, [5]].values, c=df['Status'], cmap='rainbow')

import sklearn
from sklearn.cluster import KMeans
KMeans_Clustering = KMeans(n_clusters =2, random_state=0)
KMeans_Clustering.fit(X)

#prediction
plt.scatter(data1.iloc[:, [1]].values,data1.iloc[:, [5]].values, c=KMeans_Clustering.labels_, cmap='rainbow')